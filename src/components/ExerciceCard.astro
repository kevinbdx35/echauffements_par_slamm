---
import YouTubeEmbed from './YouTubeEmbed.astro';

type VideoEntry = string | { id: string; start?: number };

interface Props {
  numero: number;
  titre: string;
  description: string;
  youtubeIds: VideoEntry[];
  duree: string;
}
const { numero, titre, description, youtubeIds, duree } = Astro.props;
const videos = youtubeIds
  .map(v => typeof v === 'string' ? { id: v, start: undefined } : v)
  .filter(v => v.id.trim() !== '');
---

<div class="bg-gray-800 rounded-xl overflow-hidden border border-gray-700">
  <div class="p-3 flex items-center gap-3">
    <span class="text-5xl font-black text-red-500 leading-none shrink-0 w-14 text-center">
      {String(numero).padStart(2, '0')}
    </span>
    <div class="flex-1 min-w-0">
      <h3 class="text-white font-bold text-base leading-tight">{titre}</h3>
      {description && (
        <p class="text-gray-400 text-sm mt-0.5">{description}</p>
      )}
    </div>
    {duree && (
      <span class="shrink-0 text-xs font-semibold text-red-400 bg-red-500/10 px-2 py-1 rounded-full">
        {duree}
      </span>
    )}
  </div>
  {videos.length > 0 ? (
    <div class="px-3 pb-3 flex flex-col gap-3">
      {videos.map(v => (
        <YouTubeEmbed youtubeId={v.id} titre={titre} start={v.start} />
      ))}
    </div>
  ) : (
    <div class="mx-3 mb-3 rounded-lg bg-gray-700/40 border border-dashed border-gray-600 flex items-center justify-center py-4">
      <span class="text-gray-500 text-xs">Vidéo à venir</span>
    </div>
  )}
</div>
