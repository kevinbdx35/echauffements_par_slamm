---
interface Props {
  youtubeId: string;
  titre: string;
}
const { youtubeId, titre } = Astro.props;
const thumbnail = `https://img.youtube.com/vi/${youtubeId}/hqdefault.jpg`;
const embedUrl = `https://www.youtube-nocookie.com/embed/${youtubeId}?autoplay=1`;
---

<div
  class="aspect-video w-full rounded-xl overflow-hidden shadow-lg relative cursor-pointer group"
  data-youtube-id={youtubeId}
  data-embed-url={embedUrl}
>
  <img
    src={thumbnail}
    alt={titre}
    class="w-full h-full object-cover"
    loading="lazy"
  />
  <div class="absolute inset-0 flex items-center justify-center bg-black/30 group-hover:bg-black/40 transition-colors">
    <div class="w-14 h-14 bg-red-500 rounded-full flex items-center justify-center shadow-lg">
      <svg class="w-6 h-6 text-white ml-1" fill="currentColor" viewBox="0 0 24 24">
        <path d="M8 5v14l11-7z"/>
      </svg>
    </div>
  </div>
</div>

<script>
  document.addEventListener('click', function (e) {
    const el = (e.target as HTMLElement).closest('[data-youtube-id]') as HTMLElement | null;
    if (!el) return;
    const iframe = document.createElement('iframe');
    iframe.src = el.dataset.embedUrl!;
    iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
    iframe.allowFullscreen = true;
    iframe.className = 'w-full h-full';
    el.innerHTML = '';
    el.appendChild(iframe);
  });
</script>
